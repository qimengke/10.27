<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="format-detection" content="telephone=no" />
<title>敢买敢送</title>
<script>
    var phoneScale = parseInt(window.screen.width)/1920;
    document.write('<meta name="viewport" content="width=1920, minimum-scale = '+ phoneScale +', maximum-scale = '+ phoneScale +', target-densitydpi=device-dpi">');
</script>
<link href="css/style.css" rel="stylesheet" type="text/css">
</head>
<body>
    <div class="wrap">
        <div class="inr">
            <a class="link1" href="">了解壹佰金理财产品</a>
            <a class="link2" href="">www.yibaijin.com</a>
            <div class="ft">
                <div class="dialWrap">
                    <div class="dial" id="dial"></div>               
                    <div class="dialBtn" id="dialBtn">
                        <p class="text"></p>
                    </div>
                </div>
            </div>
        </div>
        <div class="btmBg"></div>
    </div>
<div class="resultBox">
        <span class="ico"></span>
        <span class="resultClose" id="resultClose"></span>
        <p class="resultText">恭喜您获得<span class="award" id="award">小米移动电源</span></p>
        <form action="" method="post">
            <div class="inputsWrap">
                <input class="text1" type="text" name="" value="" placeholder="请填写您的邮寄地址">
                <input class="text2" type="text" name="" value="" placeholder="邮编">
                <input class="text3" type="text" name="" value="" placeholder="联系人">
                <input class="text4" type="text" name="" value="" placeholder="请填写您的联系电话">
            </div>
            <input class="submitBtn" type="submit" value="">
        </form>
   </div> 
            <!--除了二等奖 其他弹出页显示-->
      <div class="resultBoxForOthers">
        <span class="ico"></span>
        <span class="resultClose" id="resultClose"></span>
        <p class="resultText">恭喜您获得<span class="award" id="award">50元话费</span></p>
        <form action="" method="post">
            <input class="submitBtn" type="submit" value="">
        </form>
    </div>
    
    <div class="resultMask"></div>

    <script src="js/jquery-1.7.1.min.js" ></script>
    <script src="js/jQueryRotate.2.2.js"></script>
    <script src="js/jquery.easing.min.js"></script>
    <script>
    $(function(){
        //关闭表单弹出层
        var secondOrOthers = false;
        $(".resultBox, .resultMask").hide();
        $(".resultBoxForOthers, .resultMask").hide();
        $("#resultClose").click(function(){
        	if(secondOrOthers){
        		$(".resultBox, .resultMask").hide();
        	}else{
        		$(".resultBoxForOthers, .resultMask").hide();
        	}
            
        })

        var _time = 4000;
        var data;
        var dialLock = false; //转盘锁

        var rotateFunc = function(awards,angle,text){  //awards:奖项，angle:奖项对应的角度
            $('#dial').stopRotate();
            $("#dial").rotate({
                angle:0, 
                duration: _time, 
                animateTo: angle+1440, //angle是图片上各奖项对应的角度，1440是我要让指针旋转4圈。所以最后的结束的角度就是这样子^^
                callback:function(){
                	//如果是二等奖的化、
                	if(awards==3||awards==6||awards==8){
                		$(".resultBox, .resultMask").show();
                	}else{
                		$(".resultBoxForOthers, .resultMask").show();
                	}
                }
            }); 
        };

        $("#dialBtn").rotate({ 
            bind : { 
                click: function(){   
                    if(dialLock){
                        return false;
                    }                
                    dialLock = true; 
                    var time = [1,1];
                        time = time[Math.floor(Math.random()*time.length)];
                    if(time==0){
                        timeOut(); //网络超时
                    }
                   /*由于由5个奖项变为4个奖项 所以角度发生变化 中奖几率是有代码更改*/
                    if(time==1){
                            data = [1,2,3,4,5,6,7,8]; //返回的数组
                            data = data[Math.floor(Math.random()*data.length)];
                        if(data==1){
                            rotateFunc(1,337.5,'恭喜您抽中的四等奖')
                        }
                        if(data==2){
                            rotateFunc(2,292.5,'恭喜您抽中的三等奖')
                        }
                        if(data==3){
                            rotateFunc(3,247.5,'恭喜您抽中的二等奖')
                        }
                        if(data==4){
                            rotateFunc(4,202.5,'恭喜您抽中的四等奖')
                        }
                        if(data==5){
                            rotateFunc(5,157.5,'恭喜您抽中的三等奖')
                        }
                        if(data==6){
                            rotateFunc(6,112.5,'恭喜您抽中的二等奖')
                        }
                        if(data==7){
                            rotateFunc(7,67.5,'恭喜您抽中的一等奖')
                        }
                        if(data==8){
                            rotateFunc(8,22.5,'恭喜您抽中的二等奖')
                        }
                    }
                }
            }          
        });
    })
    </script>
</body>
</html>
